.ORIG x3000

LD R1, IFILE	
LD R2, IKRIP	

LEA	R0, MESSAGE	
PUTS	

SE_1	GETC OUT	

NOT R3, R0	

ADD	R3, R3, #10	
ADD	R3, R3, #1	

BRz	FIM_SE_1	

STR	R0, R1, #0	


VAL_1	LD	R3, MASK_1
AND	R4, R0, R3	
LD	R5, MEMORY_1	
STR	R4, R5, #0

VAL_2	LD	R3, MASK_11
		AND	R4, R0, R3	

		ADD	R4, R4, R4	
		ADD	R4, R4, R4	
		ADD	R4, R4, R4	
		LD	R5, MEMORY_2	
		STR	R4, R5, #0

VAL_100	LD	R3, MASK_CEM	
AND	R4, R0, R3	
BRz	VAL_1000
ADD	R4, R4, #-3	

VAL_1000	LD	R5, MEMORY_3	
STR	R4, R5, #0

LD	R3, MASK_MIL	
AND	R4, R0, R3	
BRz	VAL_10000
ADD	R4, R4, #-6	

VAL_10000	LD	R5, MEMORY_4	
STR	R4, R5, #0

LD	R3, MASK_10MIL	
AND	R4, R0, R3	
BRz	SOMA

ADD	R4, R4, #-12	


SOMA	LD	R5, MEMORY_5	
STR	R4, R5, #0




AND	R5, R5, #0	

LD R3, MEMORY_1	
LDR	R4, R3, #0	
ADD	R5, R5, R4	

LD R3, MEMORY_2	
LDR	R4, R3, #0	
ADD	R5, R5, R4	

LD R3, MEMORY_3	
LDR	R4, R3, #0	
ADD	R5, R5, R4	

LD R3, MEMORY_4	
LDR	R4, R3, #0	
ADD	R5, R5, R4	

LD R3, MEMORY_5	
LDR	R4, R3, #0	
ADD	R5, R5, R4	

STR	R5, R2, #0	



ADD R1, R1, #1	
ADD R2, R2, #1	

BR SE_1	

FIM_SE_1	

AND	R0, R0, #0 
ADD	R0, R0, x04 
STR	R0, R1, #0	
STR	R0, R2, #0	


AND R0, R0, #0 
AND R1, R1, #0 
AND R2, R2, #0 
AND R3, R3, #0 
AND R4, R4, #0 

LD R2, IKRIP	

LEA	R0, ENCRYTION	
PUTS	


SE_2	LDR R4, R2, #0	
ADD	R2, R2, #1	

NOT R0, R4	
ADD	R0, R0, #1	

ADD R0, R0, X04	

BRz	FIM_SE_2	

SENAO_2	AND	R0, R0, #0	

ADD R0, R0, R4	
OUT	

BR	SE_2

FIM_SE_2	HALT


IFILE	.FILL x5000	
IKRIP	.FILL x6000	
MESSAGE	.STRINGZ " Enter a MESSAGE. When you finish, press <Enter>: "	
ENCRYTION	.STRINGZ "MESSAGE encripted "	
EOF	.FILL #04 
CHEX	.FILL x-30	
MASK_1	.FILL xE0	
MASK_2	.FILL x1F	
MASK_11	.FILL x03	
MASK_CEM	.FILL x04	
MASK_MIL	.FILL x08	
MASK_10MIL	.FILL x10	
MEMORY_1	.FILL x5500	
MEMORY_2	.FILL x5501	
MEMORY_3	.FILL x5502	
MEMORY_4	.FILL x5503	
MEMORY_5	.FILL x5504	
.END